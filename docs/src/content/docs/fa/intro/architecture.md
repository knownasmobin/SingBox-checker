---
title: معماری
description: معماری Xray Checker
---

## اجزای سیستم

Xray Checker از چندین جزء کلیدی تشکیل شده که با هم کار می‌کنند تا نظارت جامع پروکسی را فراهم کنند:

### اجزای اصلی

1. **مدیر اشتراک**

   - مدیریت دریافت پیکربندی پروکسی
   - پشتیبانی از فرمت‌های ورودی متعدد
   - مدیریت به‌روزرسانی‌های پیکربندی
   - اعتبارسنجی پیکربندی‌های پروکسی

2. **یکپارچه‌سازی Xray Core**

   - مدیریت فرآیند Xray Core
   - مدیریت راه‌اندازی اتصال پروکسی
   - مدیریت پورت‌های SOCKS5
   - مدیریت به‌روزرسانی‌های پیکربندی

3. **بررسی‌کننده پروکسی**

   - انجام بررسی‌های سلامت
   - اندازه‌گیری تأخیر
   - اعتبارسنجی عملکرد پروکسی
   - مدیریت زمان‌بندی بررسی‌ها

4. **سیستم متریک**

   - جمع‌آوری متریک‌های عملکرد
   - مدیریت یکپارچه‌سازی Prometheus
   - مدیریت ذخیره‌سازی متریک‌ها
   - پشتیبانی از push gateway

5. **سرور وب**
   - ارائه endpointهای وضعیت
   - سرویس‌دهی رابط وب
   - مدیریت درخواست‌های API
   - مدیریت احراز هویت

## جزئیات اجزا

### مدیر اشتراک

مدیر اشتراک مسئولیت‌های زیر را به عهده دارد:

- دریافت پیکربندی از URL‌های اشتراک
- تجزیه فرمت‌های مختلف پیکربندی
- اعتبارسنجی پیکربندی‌های پروکسی
- راه‌اندازی به‌روزرسانی‌های پیکربندی

### یکپارچه‌سازی Xray Core

مدیریت تمام تعاملات با Xray Core:

- مدیریت چرخه عمر Xray
- تولید پیکربندی‌های Xray
- مدیریت پورت‌های SOCKS5
- مدیریت راه‌اندازی اتصال

### بررسی‌کننده پروکسی

جایی که تأیید اتصال پروکسی صورت می‌گیرد:

- بررسی‌های سلامت زمان‌بندی شده
- تست اتصال
- اندازه‌گیری تأخیر
- پیگیری وضعیت

### سیستم متریک

مدیریت تمام قابلیت‌های مرتبط با متریک:

- جمع‌آوری متریک‌های وضعیت پروکسی
- پیگیری متریک‌های تأخیر
- مدیریت یکپارچه‌سازی Prometheus
- مدیریت ارسال متریک‌ها

### سرور وب

ارائه رابط وب و API:

- مدیریت نقطه پایانی وضعیت
- سرویس‌دهی رابط وب
- پردازش درخواست‌های API
- مدیریت احراز هویت

## مدل امنیتی

### احراز هویت

- محافظت اختیاری Basic Auth
- مشخصات ورود قابل تنظیم
- احراز هویت جداگانه برای متریک‌ها

### امنیت شبکه

- فقط پورت‌های SOCKS5 محلی استفاده می‌شوند
- جلوگیری از اتصال خارجی به پروکسی‌ها
- تنظیمات timeout قابل تنظیم
- پشتیبانی از TLS برای ارسال متریک‌ها

### امنیت پیکربندی

- پشتیبانی از متغیرهای محیطی
- مدیریت امن مشخصات ورود
- نقاط پایانی متریک محافظت شده
- مدیریت ایمن و پاکسازی‌شده پیکربندی‌ها

## ملاحظات عملکرد

### استفاده از منابع

- حداقل مصرف حافظه
- بررسی بهینه پروکسی‌ها
- جمع‌آوری بهینه متریک‌ها
- توالی به‌روزرسانی کنترل شده

### مقیاس‌پذیری

- پشتیبانی از چندین پروکسی
- بررسی‌های سلامت همزمان
- مدیریت کارآمد متریک‌ها
- پشتیبانی از نظارت توزیع شده

### قابلیت اطمینان

- بازیابی خودکار
- مدیریت خطا
- مکانیزم‌های تلاش مجدد
- تخریب graceful
