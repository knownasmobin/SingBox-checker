---
title: Переменные окружения
description: Переменные окружения для Xray Checker
---

## Subscription

### SUBSCRIPTION_URL

- CLI: `--subscription-url`
- Обязательно: Да
- По умолчанию: Нет

URL, строка Base64 или путь к файлу для конфигурации прокси. Поддерживает несколько форматов:

- HTTP/HTTPS URL с Base64-кодированным содержимым
- Прямая Base64-кодированная строка
- Локальный путь к файлу с префиксом `file://`
- Локальный путь к папке с префиксом `folder://`

:::tip[Несколько подписок]
Можно указать несколько источников подписок:
- **CLI**: Используйте флаг `--subscription-url` несколько раз
- **Переменная окружения**: Разделите URL запятыми: `SUBSCRIPTION_URL="url1,url2,url3"`

Все прокси из всех источников будут объединены и мониторятся вместе.
:::

### SUBSCRIPTION_UPDATE

- CLI: `--subscription-update`
- Обязательно: Нет
- По умолчанию: `true`

Включает автоматическое обновление конфигурации прокси из источника подписки. При включении Xray Checker будет периодически проверять изменения и обновлять конфигурации соответственно.

### SUBSCRIPTION_UPDATE_INTERVAL

- CLI: `--subscription-update-interval`
- Обязательно: Нет
- По умолчанию: `300`

Время в секундах между проверками обновлений подписки. Используется только когда включен `SUBSCRIPTION_UPDATE`.

## Proxy

### PROXY_CHECK_INTERVAL

- CLI: `--proxy-check-interval`
- Обязательно: Нет
- По умолчанию: `300`

Время в секундах между проверками доступности прокси. Каждая проверка верифицирует все настроенные прокси.

### PROXY_CHECK_METHOD

- CLI: `--proxy-check-method`
- Обязательно: Нет
- По умолчанию: `ip`
- Значения: `ip`, `status`, `download`

Метод, используемый для проверки функциональности прокси:

- `ip`: Сравнивает IP-адреса с прокси и без него
- `status`: Проверяет HTTP-код состояния тестового запроса
- `download`: Скачивает файл и проверяет минимальный размер

### PROXY_IP_CHECK_URL

- CLI: `--proxy-ip-check-url`
- Обязательно: Нет
- По умолчанию: `https://api.ipify.org?format=text`

URL, используемый для проверки IP при `PROXY_CHECK_METHOD=ip`. Должен возвращать текущий IP-адрес в текстовом формате.

### PROXY_STATUS_CHECK_URL

- CLI: `--proxy-status-check-url`
- Обязательно: Нет
- По умолчанию: `http://cp.cloudflare.com/generate_204`

URL, используемый для проверки статуса при `PROXY_CHECK_METHOD=status`. Должен возвращать HTTP-код 204/200.

### PROXY_DOWNLOAD_URL

- CLI: `--proxy-download-url`
- Обязательно: Нет
- По умолчанию: `https://proof.ovh.net/files/1Mb.dat`

URL, используемый для проверки загрузки при `PROXY_CHECK_METHOD=download`. Должен возвращать загружаемый файл.

### PROXY_DOWNLOAD_TIMEOUT

- CLI: `--proxy-download-timeout`
- Обязательно: Нет
- По умолчанию: `60`

Максимальное время в секундах ожидания завершения загрузки при использовании `PROXY_CHECK_METHOD=download`.

### PROXY_DOWNLOAD_MIN_SIZE

- CLI: `--proxy-download-min-size`
- Обязательно: Нет
- По умолчанию: `51200` (50KB)

Минимальное количество байт, которое должно быть загружено для успешной проверки при использовании `PROXY_CHECK_METHOD=download`.

### PROXY_TIMEOUT

- CLI: `--proxy-timeout`
- Обязательно: Нет
- По умолчанию: `30`

Максимальное время в секундах ожидания ответа прокси во время проверок.

### PROXY_RESOLVE_DOMAINS

* CLI: `--proxy-resolve-domains`
* Обязательный: Нет
* Значение по умолчанию: `false`

При включении этой опции все конфигурации, у которых в качестве поля `server` указан домен, будут расширены в несколько отдельных конфигураций — по одной для каждого IP-адреса, полученного при DNS-резолве.
Например, если сервер указан как mydomain.com, и DNS возвращает несколько IP, то Xray Checker создаст отдельную запись под каждый адрес.

Это позволяет проверять и мониторить каждый узел по отдельности.

**Важные замечания:**

- Эта функция работает только когда домен возвращает несколько IP-адресов. Если DNS возвращает только один IP, никакого расширения не произойдет. Обратите внимание, что не все DNS-провайдеры возвращают несколько IP - например, Amazon DNS обычно возвращает только один IP-адрес.
- Эта функция работает только с протоколами, которые не проверяют сертификаты по доменному имени. Она будет работать с протоколом Reality, но **не будет работать** со стандартными протоколами vless и Trojan, где подключение устанавливается непосредственно к доменному имени и выполняется проверка сертификата.


### SIMULATE_LATENCY

- CLI: `--simulate-latency`
- Обязательно: Нет
- По умолчанию: `true`

Добавляет измеренную задержку (TTFB - Time To First Byte) в ответы эндпоинтов, полезно для систем мониторинга, которые могут интерпретировать задержки ответа.

### PROXY_RESOLVE_DOMAINS

- CLI: `--proxy-resolve-domains`
- Обязательно: Нет
- По умолчанию: `false`

При включении разрешает доменные имена серверов прокси в IP-адреса и создаёт отдельные конфигурации для каждого разрешённого IP. Полезно, когда домен указывает на несколько серверов.

## Web UI

### WEB_SHOW_DETAILS

- CLI: `--web-show-details`
- Обязательно: Нет
- По умолчанию: `false`

Показывает IP-адреса и порты серверов в веб-интерфейсе. При отключении отображаются только имена прокси для конфиденциальности.

### WEB_PUBLIC

- CLI: `--web-public`
- Обязательно: Нет
- По умолчанию: `false`

Делает дашборд публичным без аутентификации. При включении дашборд отображает имя подписки в качестве заголовка, скрывает административные элементы и технические детали (версию, порты, ссылки на конфиги).

:::caution[Требуется защита метрик]
Эта опция требует `METRICS_PROTECTED=true`. Эндпоинт `/metrics` и API по-прежнему будут требовать аутентификацию, но главный дашборд (`/`) и страницы статуса отдельных прокси (`/config/{id}`) будут публичными.
:::

## Xray

### XRAY_START_PORT

- CLI: `--xray-start-port`
- Обязательно: Нет
- По умолчанию: `10000`

Начальный номер порта для SOCKS5 прокси. Каждый прокси будет использовать последовательные порты, начиная с этого номера.

### XRAY_LOG_LEVEL

- CLI: `--xray-log-level`
- Обязательно: Нет
- По умолчанию: `none`
- Значения: `debug`, `info`, `warning`, `error`, `none`

Управляет уровнем детализации логирования Xray Core.

## Metrics

### METRICS_HOST

- CLI: `--metrics-host`
- Обязательно: Нет
- По умолчанию: `0.0.0.0`

Адрес для эндпоинтов метрик и статуса.

### METRICS_PORT

- CLI: `--metrics-port`
- Обязательно: Нет
- По умолчанию: `2112`

Номер порта для HTTP-сервера, предоставляющего эндпоинты метрик и статуса.

### METRICS_PROTECTED

- CLI: `--metrics-protected`
- Обязательно: Нет
- По умолчанию: `false`

Включает базовую аутентификацию для эндпоинтов метрик и статуса.

### METRICS_USERNAME

- CLI: `--metrics-username`
- Обязательно: Нет
- По умолчанию: `metricsUser`

Имя пользователя для базовой аутентификации при `METRICS_PROTECTED=true`.

### METRICS_PASSWORD

- CLI: `--metrics-password`
- Обязательно: Нет
- По умолчанию: `MetricsVeryHardPassword`

Пароль для базовой аутентификации при `METRICS_PROTECTED=true`.

### METRICS_INSTANCE

- CLI: `--metrics-instance`
- Обязательно: Нет
- По умолчанию: Нет

Метка экземпляра, добавляемая ко всем метрикам. Полезно для различения нескольких экземпляров Xray Checker.

### METRICS_PUSH_URL

- CLI: `--metrics-push-url`
- Обязательно: Нет
- По умолчанию: Нет

URL Prometheus Pushgateway для отправки метрик. Формат: `https://user:pass@host:port`

### METRICS_BASE_PATH

- CLI: `--metrics-base-path`
- Обязательно: Нет
- По умолчанию: ""

URL-путь, по которому будут доступны метрики и страница для их мониторинга. Формат: `/vpn/metrics`. Мониторинг будет доступен по адресу `http://localhost:port/metrics-base-path`

## Other

### LOG_LEVEL

- CLI: `--log-level`
- Обязательно: Нет
- По умолчанию: `info`
- Значения: `debug`, `info`, `warn`, `error`, `none`

Управляет уровнем детализации логирования приложения Xray Checker. Примечание: Это отдельно от `XRAY_LOG_LEVEL`, который управляет логированием Xray Core.

### RUN_ONCE

- CLI: `--run-once`
- Обязательно: Нет
- По умолчанию: `false`

Выполняет один цикл проверки и завершает работу. Полезно для сред с запланированным выполнением.
